# Miloco Server Configuration
# Unified management of all server configuration items

# Directory path configuration
# Storage directory can be overridden by environment variable MILOCO_SERVER_STORAGE_DIR
# Default to relative path for portability
directories:
  templates: "templates"
  static: "static"
  storage: ".temp"  # Can be overridden by MILOCO_SERVER_STORAGE_DIR env var

# Database configuration
database:
  path: "miloco.db"
  timeout: 30.0 
  check_same_thread: false
  isolation_level: null

# Server configuration
server:
  host: "0.0.0.0"
  port: 8000
  log_level: "info"
  enable_console_logging: true
  enable_file_logging: true

# Application information configuration
app:
  title: "Miloco server"
  service_name: "miloco-server"
  description: "Miloco server, responsible for scheduling various modules"
  version: "0.0.1"

# JWT authentication configuration
jwt:
  secret_key: "your-super-secret-key-change-this"  # Get from environment variable SECRET_KEY, default to this value
  algorithm: "HS256"
  access_token_expire_minutes: 1440  #minutes

# Local model configuration
local_model:
  host: "0.0.0.0"
  port: 8001

# Chat configuration
chat:
  agent_max_steps: 10
  vision_use_img_count: 6
  chat_history_ttl: 30 #days

# Trigger rule runner configuration
trigger_rule_runner:
  interval_seconds: 2
  vision_use_img_count: 6
  trigger_rule_log_ttl: 30 #days

# Camera configuration
camera:
  frame_interval: 2000 # Unit: Millisecond (ms)
  # Hardware acceleration configuration
  # Enable hardware acceleration for video decoding (HEVC/H.265, H.264)
  # Requires Intel/AMD GPU with VAAPI support and appropriate drivers
  enable_hw_accel: true
  # Hardware acceleration type (vaapi for Linux Intel/AMD GPUs)
  hw_accel_type: "vaapi"
  # Hardware device path (typically /dev/dri/renderD128 for Intel GPUs)
  hw_device_path: "/dev/dri/renderD128"
  # Per-camera video quality configuration
  # Format: camera_did: quality_level
  # Quality levels: 1=LOW, 2=MEDIUM, 3=HIGH
  # Example: "123456789": 3 would set camera with did "123456789" to HIGH quality
  camera_qualities: {}  # Leave empty to use default quality for all cameras
  default_quality: 2  # Default to MEDIUM (2) if not specified


# MIoT configuration, default to 'cn', use your MiHome cloud server
  # 'cn': '中国大陆'
  # 'de': 'Europe'
  # 'i2': 'India'
  # 'ru': 'Russia'
  # 'sg': 'Singapore'
  # 'us': 'United States
miot:
  cloud_server: "cn"
